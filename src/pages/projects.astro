---
import BaseLayout from "../layouts/BaseLayout.astro";

const projects = [
  {
    title: "Brownian Crystallisation",
    category: "Physics",
    poster: "/images/crystallisation-static.png",
    video: "/images/crystallisation.mp4",
    link: "/projects/crystallisation",
    stack: ["Python", "NumPy", "Matplotlib", "Monte Carlo"]
  },
  {
    title: "Two-Stream Instability Simulation",
    category: "Physics",
    poster: "/images/twostream-static.png",
    video: "/images/twostream.mp4",
    link: "/projects/plasma",
    stack: ["Python", "NumPy", "SciPy", "Matplotlib"]
  },
  {
    title: "Nanodevice Instrumentation Researcher & Materials Physicist",
    category: "Engineering",
    poster: null,
    video: null,
    link: "/projects/afm",
    stack: ["AFM", "Cryogenics", "DAQ", "Python", "Open-Source Control", "Electromechanical Design"]
  },
  {
    title: "Trust in Science Survey Analysis",
    category: "Data Science",
    poster: null,
    video: null,
    link: "/projects/gender-sentiment",
    stack: ["Statistical Analysis", "Survey Data", "Python", "pandas", "Regression"]
  }
];
---

<BaseLayout title="Projects">
  <section class="projects-container">
    {projects.map(project => (
      <a href={project.link} class="project-card">
        <div class="project-media">
          <video
            class="project-video"
            src={project.video}
            poster={project.poster}
            muted
            loop
            playsinline
            preload="none"
          ></video>
        </div>

        <h3 class="project-title">{project.title}</h3>

        <!-- Category badge (only once) -->
        <div class="tag-row">
          <span class={`badge badge-${project.category.toLowerCase().replace(/\s+/g, "-")}`}>
            {project.category}
          </span>
        </div>

        <!-- Tech stack pills -->
        {project.stack?.length > 0 && (
          <div class="tag-row tag-row-tech">
            {project.stack.slice(0, 5).map(item => (
              <span class="tag-pill">{item}</span>
            ))}
            {project.stack.length > 5 && (
              <span class="tag-pill tag-pill-muted">+ more</span>
            )}
          </div>
        )}
      </a>
    ))}
  </section>
</BaseLayout>

<script>
  document.querySelectorAll(".project-video").forEach(video => {
    video.addEventListener("mouseenter", () => {
      video.currentTime = 0;
      video.play();
    });

    video.addEventListener("mouseleave", () => {
      video.pause();
      video.currentTime = 0;
    });
  });
</script>
